{% extends "base.html" %}
{% load interventions %}
{% load captureas %}



{% block title_base %}
    &#183; Forums
{% endblock %}



{% block mobile_title %}
    Forums
{% endblock %}



{% block breadcrumb_base %}
    <li><a href="{% url "zds.forum.views.index" %}">Forums</a></li>
{% endblock %}



{% block menu_forum %}
    current
{% endblock %}



{% block sidebar %}
    <aside class="sidebar mobile-menu-hide">
        {% if user.is_authenticated %}
            {% captureas sidebaractions %}
                {% block sidebar_actions %}{% endblock %}
            {% endcaptureas %}

            {% if sidebaractions %}
                <div class="mobile-menu-bloc mobile-all-links mobile-show-ico" data-title="Actions">
                    <h3>Actions</h3>
                    <ul>
                        {{ sidebaractions|safe }}
                    </ul>
                </div>
            {% endif %}

            <div class="mobile-menu-bloc mobile-all-links" data-title="Sujets suivis">
                <h3>Sujets suivis</h3>
                <ul>
                    {% with topics=user|followed_topics %}
                        {% for topic in topics %}
                            {% with topic=topic.topic state=topic|is_read %}
                                <li>
                                    <a href="{% url "zds.forum.views.edit" %}?topic={{ topic.pk }}&page=1&follow=1" 
                                       class="ico-after cross red stop-follow action-hover" 
                                       data-title="Ne plus suivre">
                                        Ne plus suivre
                                    </a>
                                    <a href="
                                        {% if first_unread %}
                                            {{ first_unread.get_absolute_url }}
                                        {% else %}
                                            {{ topic.last_read_post.get_absolute_url }}
                                        {% endif %}"
                                       class="{% if state != True %}unread{% endif %}
                                        {% if topic.is_solved or topic.is_locked %}
                                            ico-after

                                            {% if topic.is_solved %}
                                                tick active
                                            {% elif topic.is_locked %}
                                                lock
                                            {% endif %}
                                        {% endif %}"
                                       {% if topic.is_solved or topic.is_locked %}
                                        data-prefix="{% if topic.is_solved %}Résolu{% elif topic.is_locked %}Fermé{% endif %}"
                                       {% endif %}
                                    >
                                        {{ topic.title }}
                                    </a>
                                </li>
                            {% endwith %}
                        {% endfor %}

                        {% if topics|length <= 0 %}
                            <li class="inactive"><span>Aucun sujet suivi</span></li>
                        {% endif %}
                    {% endwith %}
                </ul>
            </div>

            <div class="mobile-menu-bloc mobile-all-links" data-title="Flux">
                <h3>Flux</h3>
                <ul>
                    <li><a href="{% url "post-feed-rss" %}">Nouveaux messages (RSS)</a></li>
                    <li><a href="{% url "post-feed-atom" %}">Nouveaux messages (ATOM)</a></li>
                    <li><a href="{% url "topic-feed-rss" %}">Nouveaux sujets (RSS)</a></li>
                    <li><a href="{% url "topic-feed-atom" %}">Nouveaux sujets (ATOM)</a></li>
                </ul>
            </div>
        {% endif %}
    </aside>
{% endblock %}